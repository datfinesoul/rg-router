"use strict";var _extends=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)){r[n]=e[n]}}}return r};(function(){Array.prototype.find=Array.prototype.find||(Array.prototype.find=function(r){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof r)throw new TypeError("predicate must be a function");for(var t,e=Object(this),n=e.length>>>0,i=arguments[1],a=0;n>a;a++)if(t=e[a],r.call(i,t,a,e))return t;return void 0});var r=[];var t={hash:"#!",add:function s(n){if(!n||!n.name){throw"Please specify a state name";return}var i=e(n);if(i)i=n;else{if(n.url&&n.url[0]==="/")n.url=n.url.substr(1);if(typeof n.url==="string"&&n.url.slice(-1)!=="/")n.url=n.url+"/";r.push(n)}t.trigger("add",i);return this},remove:function f(e){var n=undefined;r=r.filter(function(r){if(r.name!=e)return r;else n=r});t.trigger("remove",n);return this},go:function l(r,n,i,a){if(!t.active||!r)return;var u=e(r);if(!u){throw"State '"+r+"' has not been configured";return}if(n)u.params=n;var s=r.split(".");s=s.map(function(r,t){if(t>0){return s.slice(0,t).join(".")+"."+r}else{return r}});s.forEach(function(r,t){if(t<s.length){var n=e(r);u=_extends({},n,u)}});if(typeof u.resolve=="function"){var f=u.resolve();if(typeof f.then=="function")f.then(function(){return o(u,i)})}else{o(u,i,a)}return this},start:function c(){t.active=true;if(window.location.hash){var r=new RegExp("^"+t.hash);var e=window.location.hash.replace(r,"")||"/";var o=n(e);if(o)t.go(o.name,null,null,true)}else if(t.hash===""){var o=n(window.location.pathname.slice(1));if(o)t.go(o.name)}window.addEventListener("popstate",i);window.addEventListener("hashchange",a);t.trigger("start");return this},stop:function h(){t.active=false;window.removeEventListener("popstate",i);window.addEventListener("hashchange",a);t.trigger("stop");return this},current:undefined,active:false};function e(t){return r.find(function(r){return r.name==t})}function n(t){if(t&&t.length>1&&t[0]==="/")t=t.substr(1);if(typeof t==="string"&&t.slice(-1)!=="/")t=t+"/";var e=r.find(function(r){return r.url==t});if(e)return e;return r.find(function(r){if(!r.url)return false;var e=r.url.split("/");var n=t.split("/");r.params=r.params||{};for(var i=0;i<e.length;i++){var a=e[i];var o=n[i];if(a[0]==":"){r.params[a.substr(1)]=o}else if(a!=o){return false}}return true})}function i(r){if(r.state)t.go(r.state.name,r.state.params,true)}function a(r){var e=new RegExp("^"+t.hash);var i=window.location.hash.replace(e,"")||"/";var a=n(i);if(a)t.go(a.name,a.params,true,true)}function o(r,e,n){if(typeof history.pushState!="undefined"&&r.history!=false&&n!=true){if(!history.state||!e){var i={};for(var a in r){if(r.hasOwnProperty(a)&&typeof r[a]!=="function"){i[a]=r[a]}}history.pushState(i,null,u(r))}}var o=t.current;t.current=r;t.trigger("go",r,o)}function u(r){if(r.params){var e=r.url.split("/");var n=e.map(function(t){if(t[0]!=":")return t;return r.params[t.substr(1)]}).filter(function(r){return r?true:false}).join("/");return t.hash+"/"+(n?n+"/":"")}return r.hasOwnProperty("url")?t.hash+"/"+(r.url==="/"?"":"/"):null}riot.observable(t);riot.mixin("rg.router",{init:function p(){var r=this;this.router.on("go",function(){return r.update()})},router:t});if(!window.rg)window.rg={};window.rg.router=t})();